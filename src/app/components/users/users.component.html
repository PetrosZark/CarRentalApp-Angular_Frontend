<div class="container mt-4">
    <h2>Manage Users</h2>
  
    <!-- Success and Error Popups -->
    <div *ngIf="showSuccessPopup" class="alert alert-success alert-dismissible fade show">
      {{ successMessage }}
      <button type="button" class="btn-close" aria-label="Close" (click)="showSuccessPopup = false"></button>
    </div>
  
    <div *ngIf="showErrorPopup" class="alert alert-danger alert-dismissible fade show">
      {{ errorMessage }}
      <button type="button" class="btn-close" aria-label="Close" (click)="showErrorPopup = false"></button>
    </div>
  
   <!-- Filter and Pagination Controls -->
   <div class="row mb-3">
    <div class="col-md-12">
      <input
        type="text"
        class="form-control"
        placeholder="Search by VAT..."
        [(ngModel)]="filters.searchQuery"
        (keyup.enter)="applyFilters()"
      />
    </div>
    <div class="col-md-12 text-end mt-2">
      <button class="btn btn-primary" (click)="applyFilters()">Search</button>
    </div>
  </div>

  
    <!-- Users Table -->
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Username</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Email</th>
        <th>VAT</th>
        <th>Phone</th>
        <th>Status</th>
        <th>Role</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of users">
        <td>{{ user.username }}</td>
        <td>{{ user.firstname }}</td>
        <td>{{ user.lastname }}</td>
        <td>{{ user.email }}</td>
        <td>{{ user.vat }}</td>
        <td>{{ user.phone }}</td>
        <td>{{ user.isActive ? 'Active' : 'Inactive' }}</td>
        <td>{{ user.role }}</td>
        <td>
          <button class="btn btn-warning btn-sm me-2" (click)="toggleStatus(user.username)">
            Toggle Status
          </button>
          <button class="btn btn-info btn-sm me-2" (click)="changeRole(user.username)">
            Change Role
          </button>
          <button class="btn btn-danger btn-sm" (click)="deleteUser(user.username)">
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>
  
    <nav>
      <ul class="pagination justify-content-center">
        <li class="page-item" [class.disabled]="currentPage === 0">
          <button class="page-link" (click)="goToPage(currentPage - 1)">Previous</button>
        </li>
        <li
          class="page-item"
          *ngFor="let page of totalPagesArray"
          [class.active]="page === currentPage"
        >
          <button class="page-link" (click)="goToPage(page)">{{ page + 1 }}</button>
        </li>
        <li class="page-item" [class.disabled]="currentPage === totalPages - 1">
          <button class="page-link" (click)="goToPage(currentPage + 1)">Next</button>
        </li>
      </ul>
    </nav>
  </div>
  